<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Card</title>
    <link rel="stylesheet" href="proStyle.css">
    <link rel="stylesheet" href="../navigation/nav3.css">
</head>
<body>
    <div class="navContainer">
        
       
        <nav id="top-nav">
            <ul>  
                <li> <a href="profile.html">Profile</a>  </li>
                <li> <a href="../calendar/calIndex.html">Club Events</a>  </li>
                <li> <a href="../listings/listings 2.html">Listings</a>  </li>
                <li> <a href="../threads/threads.html">Threads</a>  </li>
               
            </ul>
        </nav>


                <p id="requests-button" style="text-align: center; display: inline-block"><a class="listingsButton" href="../requests/requests.html">+</a></p>


    </div>
    <div class="container">
        <div class="profile-box">
            <!-- <img src="images/menu.png" class="menu-icon>">
            <img src="images/setting.png" class="setting-icon>">  -->
            <img src="../pfps/Default_pfp.svg.png" class="profile-pic">
            <h3>Guest User</h3>
            <p>Student at the University of Notre Dame</p>
            <div class="social-media">
                <img src="../logos/instagram.png">
                <img src="../icons/telegram.png">
                <img src="../icons/dribble.png">
        </div>
        <button type="button">0 Followers</button>
        <div class="profile-bottom">
            <p>Upcoming Events:</p>
            <!-- Events will be loaded dynamically by profileManager.js -->
        </div>



        </div>
    </div>

    <script>
        // Profile Manager - handles user profile information across the site
        
        // Function to get current user profile (used by other pages)
        function getCurrentUserProfile() {
            const storedUser = localStorage.getItem('userProfile');
            if (storedUser) {
                try {
                    return JSON.parse(storedUser);
                } catch (e) {
                    console.error('Error parsing user profile from localStorage:', e);
                }
            }
            
            // Default fallback for guest users
            return {
                name: "Guest User",
                username: "guest", 
                profileImage: "pfps/Default_pfp.svg.png",
                isSpecialUser: false
            };
        }
        
        // Function to extract profile info from profile.html when user visits it
        function extractProfileFromPage() {
            // Get the current user profile from localStorage (set during login)
            const currentUser = getCurrentUserProfile();
            
            // Update the page elements with current user info
            const profileName = document.querySelector('.profile-box h3');
            const profileImage = document.querySelector('.profile-pic');
            const followersButton = document.querySelector('.profile-box button');
            
            if (profileName && currentUser) {
                profileName.textContent = currentUser.name;
            }
            
            if (profileImage && currentUser) {
                profileImage.src = `../${currentUser.profileImage}`;
            }
            
            if (followersButton && currentUser) {
                // Show different follower counts for different users
                if (currentUser.isSpecialUser) {
                    followersButton.textContent = "13 Followers";
                } else {
                    followersButton.textContent = "0 Followers";
                }
            }
            
            return currentUser;
        }
        
        // Function to load and display upcoming events from user interests
        function loadUpcomingEvents() {
            const userInterests = JSON.parse(localStorage.getItem('userInterests')) || [];
            const profileBottom = document.querySelector('.profile-bottom');
            const currentUser = getCurrentUserProfile();
            
            if (profileBottom && userInterests.length > 0) {
                // Clear existing content except the header
                profileBottom.innerHTML = '<p>Upcoming Events:</p>';
                
                // Add each user interest as an upcoming event
                userInterests.forEach(event => {
                    const eventParagraph = document.createElement('p');
                    eventParagraph.textContent = `${event.title} | ${event.date}`;
                    profileBottom.appendChild(eventParagraph);
                });
            } else if (profileBottom && userInterests.length === 0) {
                // Show different messages for different user types
                if (currentUser && currentUser.isSpecialUser) {
                    profileBottom.innerHTML = '<p>Upcoming Events:</p><p>No upcoming events yet.</p>';
                } else {
                    profileBottom.innerHTML = `
                        <p>Upcoming Events:</p>
                        <p>No events yet! Visit the Listings page to join some activities.</p>
                    `;
                }
            }
        }
        
        // Initialize profile extraction if we're on the profile page
        document.addEventListener('DOMContentLoaded', function() {
            // Check if we're on the profile page
            if (document.querySelector('.profile-box')) {
                extractProfileFromPage();
                loadUpcomingEvents();
            }
        });
    </script>
</head>
</html>



 

